[![Add to Sidekick](https://img.shields.io/badge/Franklin-Sidekick-%23F15A3A?style=for-the-badge&logo=data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI0LjIuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxNiAxNiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTYgMTY7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojRjE1QTNBO30KCS5zdDF7ZmlsbDojQzcxRjNEO30KCS5zdDJ7ZmlsbDojRkZDNDBDO30KPC9zdHlsZT4KPGc+Cgk8Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSIxLjciIGN5PSI4IiByPSIxLjciLz4KCTxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE0LjMiIGN5PSI4IiByPSIxLjciLz4KCTxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjQuNyIgY3k9IjIiIHI9IjIiLz4KCTxjaXJjbGUgY2xhc3M9InN0MiIgY3g9IjEyIiBjeT0iMiIgcj0iMS4zIi8+Cgk8Y2lyY2xlIGNsYXNzPSJzdDEiIGN4PSIxMiIgY3k9IjE0IiByPSIyIi8+Cgk8Y2lyY2xlIGNsYXNzPSJzdDIiIGN4PSI0LjciIGN5PSIxNCIgcj0iMS4zIi8+CjwvZz4KPC9zdmc+Cg==)](https://www.hlx.live/tools/sidekick/?project=Maidenform&giturl=https%3A%2F%2Fgithub.com%2Fhlxsites%2Fmaidenform%2Ftree%2Fmain)


# Franklin Maidenform
Your project's description...

## Environments
- Preview: https://main--maidenform--hlxsites.hlx.page/
- Live: https://main--maidenform--hlxsites.hlx.live/

## Installation

```sh
npm i
# or
yarn
```

## Start

```sh
npm run start
# or
yarn start
```

## Local development

1. Create a new repository based on the `helix-project-boilerplate` template and add a mountpoint in the `fstab.yaml`
1. Add the [helix-bot](https://github.com/apps/helix-bot) to the repository
1. Install the [Helix CLI](https://github.com/adobe/helix-cli): `npm install -g @adobe/helix-cli`
1. Start Helix Pages Proxy: `hlx up` (opens your browser at `http://localhost:3000`)
1. Open the `{repo}` directory in your favorite IDE and start coding :)


## Choosing the enviroment

When not running the production website (anything containing `maidenform.com`) you have the ability to change the default enviroment through two different means.

Currently three enviroment exits:
- `dev`
- `stage`
- `prod`

You can change the environment for a single page by appending the following query parameter `config` with the environment name. For the homepage in local devolopment, this would result in https://localhost:3000/?config=stage for staging.

You can also modify the enviroment through the session storage this will make sure you can trough a full checkout process on the same enviroment. You would do that by adding an `environment` variable with the name of the desired environment. You can still override this setting by modifying the query parameters `config`.

## Sitemap

The [sitemap.xml](http://franklin.maidenfor.com/sitemap.xml) is generated by gathering the content of two indexes though the [helix-sitemap.yaml](./helix-sitemap.yaml):
- [the static index](https://franklin.maidenform.com/query-index.json)
- [the products index](https://franklin.maidenform.com/products/query-index.json)

The static index is directly managed by Franklin upon publication and unpublication of pages. 

The Products index is managed through a [GitHub action](./github/workflows/sync-commerce.yaml), that will trigger the reindexing of the product pages it will gather the products from querying Commerce GraphQL. The product index is run daily or through a manual execution.

To be able to remove products pages from the sitemap:
1. The `/products/query-index.xlsx` should be emptied
2. The `sync-commerce` GitHub Action should be executed, this will ensure that only product currently available will be added 
